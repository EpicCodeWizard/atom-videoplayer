"undefined"!==typeof process&&"v4.0.0">process.version&&console.warn("Module "+("undefined"==typeof module?"":module.filename)+" requires node.js version 4.0.0 or higher");
(function(l){function m(a){return a instanceof Array?function(){return f.iter(a)}:"function"==typeof a.iterator?e(a,a.iterator):a.iterator}function e(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=n++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var f=function(){};f.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+
c;else return"";return a.substr(b,c)};f.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var h=function(){};h.has=function(a,b){for(var c=m(a)();c.hasNext();)if(c.next()==b)return!0;return!1};var d=l.VideoPlayer=function(a){var b=this;this.file=new p(a.path);this.wheelSpeed=this.seekSpeed=1;window.getComputedStyle(atom.views.getView(atom.workspace));this.element=window.document.createElement("div");this.element.classList.add("videoplayer");
this.element.setAttribute("tabindex","-1");this.video=window.document.createElement("video");this.video.controls=!0;this.video.src=this.file.getPath();null!=a.play&&(this.video.autoplay=a.play);null!=a.time&&(this.video.currentTime=a.time);null!=a.volume&&(this.video.volume=a.volume);this.element.appendChild(this.video);this.video.addEventListener("playing",e(this,this.handleVideoPlay),!1);this.video.addEventListener("ended",e(this,this.handleVideoEnd),!1);this.video.addEventListener("error",e(this,
this.handleVideoError),!1);this.video.addEventListener("canplaythrough",e(this,this.handleVideoCanPlay),!1);this.video.addEventListener("click",e(this,this.handleVideoClick),!1);this.commands=new k;this.commands.add(atom.commands.add(this.element,"videoplayer:toggle-playback",function(a){b.isPlaying?b.pause():b.play()}));this.commands.add(atom.commands.add(this.element,"videoplayer:toggle-mute",function(a){b.video.muted=!b.video.muted}));this.commands.add(atom.commands.add(this.element,"videoplayer:seek-backward",
function(a){b.seek(-(b.video.duration/10*b.seekSpeed))}));this.commands.add(atom.commands.add(this.element,"videoplayer:seek-forward",function(a){b.seek(b.video.duration/10*b.seekSpeed)}));this.commands.add(atom.commands.add(this.element,"videoplayer:goto-start",function(a){b.video.currentTime=0}));this.commands.add(atom.commands.add(this.element,"videoplayer:goto-end",function(a){b.video.currentTime=b.video.duration}))};d.activate=function(a){d.disposables=new k;d.disposables.add(atom.workspace.addOpener(d.openURI))};
d.deactivate=function(){d.disposables.dispose()};d.openURI=function(a){var b=g.extension(a).toLowerCase();return h.has(d.allowedFileTypes,b)?new d({path:a,play:atom.config.get("video.autoplay"),time:null,volume:atom.config.get("video.volume")}):null};d.consumeStatusBar=function(a){};d.deserialize=function(a){return new d(a)};d.prototype={serialize:function(){return{deserializer:"VideoPlayer",path:this.file.getPath(),play:!this.video.paused,time:this.video.currentTime,volume:this.video.volume}},dispose:function(){this.commands.dispose();
this.element.removeEventListener("mousewheel",e(this,this.handleMouseWheel));this.video.removeEventListener("playing",e(this,this.handleVideoPlay));this.video.removeEventListener("ended",e(this,this.handleVideoEnd));this.video.removeEventListener("error",e(this,this.handleVideoError));this.video.removeEventListener("canplaythrough",e(this,this.handleVideoCanPlay));this.video.removeEventListener("click",e(this,this.handleVideoClick));this.video.pause();this.video.remove();this.video=null},getPath:function(){return this.file.getPath()},
getTitle:function(){return this.file.getBaseName()},getURI:function(){var a=this.file.getPath();return"file://"+encodeURIComponent(a)},enterFullscreen:function(){this.video.webkitRequestFullscreen()},exitFullscreen:function(){window.document.webkitExitFullscreen()},toggleFullscreen:function(){window.document.webkitIsFullScreen?window.document.webkitExitFullscreen():this.video.webkitRequestFullscreen()},togglePlayback:function(){this.isPlaying?this.pause():this.play()},toggleMute:function(){this.video.muted=
!this.video.muted},play:function(){this.isPlaying||(this.isPlaying=!0,this.video.play())},pause:function(){this.isPlaying&&(this.isPlaying=!1,this.video.pause())},seek:function(a){null!=this.video.currentTime&&(this.video.currentTime+=a);return this.video.currentTime},handleVideoCanPlay:function(a){this.video.removeEventListener("canplaythrough",e(this,this.handleVideoCanPlay));this.element.addEventListener("mousewheel",e(this,this.handleMouseWheel),!1)},handleVideoPlay:function(a){},handleVideoEnd:function(a){this.isPlaying=
!1;window.document.webkitIsFullScreen&&window.document.webkitExitFullscreen()},handleVideoError:function(a){},handleVideoClick:function(a){a.ctrlKey?window.document.webkitIsFullScreen?window.document.webkitExitFullscreen():this.video.webkitRequestFullscreen():this.isPlaying?this.pause():this.play()},handleMouseWheel:function(a){var b=a.wheelDelta/100*this.wheelSpeed;a.ctrlKey&&(b*=10,a.shiftKey&&(b*=10));this.seek(b)}};var k=require("atom").CompositeDisposable,p=require("atom").File,g=function(a){switch(a){case ".":case "..":this.dir=
a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=f.substr(a,0,c),a=f.substr(a,c+1,null),this.backslash=!0):c<b?(this.dir=f.substr(a,0,b),a=f.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=f.substr(a,b+1,null),this.file=f.substr(a,0,b)):(this.ext=null,this.file=a)};g.extension=function(a){a=new g(a);return null==a.ext?"":a.ext};require("buffer");var n=0;module.exports=d;d.allowedFileTypes="3gp avi mov mp4 m4v mkv ogv ogm webm".split(" ")})("undefined"!=
typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this);
