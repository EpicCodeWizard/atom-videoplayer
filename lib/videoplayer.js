(function(e,y){function G(a){return a instanceof Array?function(){return m.iter(a)}:"function"==typeof a.iterator?u(a,a.iterator):a.iterator}function u(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=H++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var v=function(){return d.__string_rec(this,"")},m=function(){};m.__name__=!0;m.substr=
function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};m.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var z=function(){};z.__name__=!0;z.has=function(a,b){for(var c=G(a)();c.hasNext();)if(c.next()==b)return!0;return!1};var g=function(){};g.__name__=!0;g.activate=function(a){e.log("Atom-videoplayer ");g.disposables=
new A;g.disposables.add(atom.workspace.addOpener(g.openURI));g.disposables.add(atom.views.addViewProvider(n,function(a){return(new r(a)).element}))};g.deactivate=function(){g.disposables.dispose();g.statusbar.destroy()};g.consumeStatusBar=function(a){g.statusbar=new w;a.addLeftTile({item:g.statusbar.element,priority:10})};g.openURI=function(a){var b=q.extension(a).toLowerCase();return z.has(g.allowedFileTypes,b)?new n(a):null};Math.__name__=!0;var w=function(){var a=this;this.element=window.document.createElement("span");
this.element.setAttribute("is","status-bar-videoplayer");this.element.classList.add("videoplayer-status","inline-block","icon","icon-device-camera-video");this.disposables=new A;this.disposables.add(atom.workspace.onDidChangeActivePaneItem(function(b){b=atom.workspace.getActivePaneItem();if(d.__instanceof(b,n)){b=d.__cast(b,n);var c=atom.views.getView(b).children[0];c.addEventListener("canplaythrough",function(b){a.element.textContent=c.videoWidth+"x"+c.videoHeight;a.element.style.display="inline-block"},
!1)}else a.element.textContent="",a.element.style.display="none"}))};w.__name__=!0;w.prototype={destroy:function(){e.log("destroy");this.disposables.dispose()},__class__:w};var t=function(){};t.__name__=!0;t.string=function(a){return d.__string_rec(a,"")};var B=function(){};B.__name__=!0;B.urlEncode=function(a){return encodeURIComponent(a)};var n=function(a){this.file=new I(a)};n.__name__=!0;n.prototype={getViewClass:function(){e.log("getViewClass");return r},destroy:function(){atom.views.getView(this).remove()},
getPath:function(){return this.file.getPath()},getIconName:function(){e.log("getIconName");return"git-branch"},getTitle:function(){return this.file.getBaseName()},getURI:function(){return B.urlEncode(this.getPath())},isEqual:function(a){e.log("isEqual "+a);return d.__instanceof(a,n)?this.getURI()==d.__cast(a,n).getURI():!1},__class__:n};var r=function(a){var b=this;this.isPlaying=!0;this.isFullscreen=!1;this.seekSpeed=atom.config.get("videoplayer.seek_speed");this.wheelSpeed=atom.config.get("videoplayer.wheel_speed");
this.element=window.document.createElement("div");this.element.classList.add("videoplayer");this.element.setAttribute("tabindex","-1");this.video=window.document.createElement("video");this.video.autoplay=!0;this.video.controls=!0;this.video.loop=atom.config.get("videoplayer.loop");this.video.volume=atom.config.get("videoplayer.volume");this.video.src=a.getPath();this.element.appendChild(this.video);this.element.addEventListener("mousewheel",u(this,this.handleMouseWheel),!1);this.video.addEventListener("click",
u(this,this.handleClickVideo),!1);this.video.addEventListener("ended",u(this,this.handleVideoEnd),!1);this.video.addEventListener("error",function(a){atom.notifications.addWarning("Failed to play "+a.target.src)},!1);(new MutationObserver(function(a,f){b.isPlaying&&b.video.play()})).observe(this.element,{attributes:!0});this.disposables=new A;this.disposables.add(atom.commands.add(this.element,"videoplayer:toggle-playback",function(a){b.togglePlayback()}));this.disposables.add(atom.commands.add(this.element,
"videoplayer:toggle-mute",function(a){b.toggleMute()}));this.disposables.add(atom.commands.add(this.element,"videoplayer:seek-backward",function(a){b.seek(-(b.video.duration/10*b.seekSpeed))}));this.disposables.add(atom.commands.add(this.element,"videoplayer:seek-forward",function(a){b.seek(b.video.duration/10*b.seekSpeed)}));this.disposables.add(atom.commands.add(this.element,"videoplayer:goto-start",function(a){b.video.currentTime=0}));this.disposables.add(atom.commands.add(this.element,"videoplayer:goto-end",
function(a){b.video.currentTime=b.video.duration}))};r.__name__=!0;r.prototype={initialize:function(a){e.log("initialize");e.log(a)},contains:function(){e.log("contains");return!1},destroy:function(){e.log("destroy")},attached:function(){e.log("attached")},detached:function(){e.log("detached")},focus:function(){e.log("focus")},onDidLoad:function(a){e.log("onDidLoad "+a)},getPane:function(){e.log("getPane")},play:function(){this.isPlaying||(this.isPlaying=!0,this.video.play())},pause:function(){this.isPlaying&&
(this.isPlaying=!1,this.video.pause())},seek:function(a){null!=this.video.currentTime&&(this.video.currentTime+=a)},togglePlayback:function(){this.isPlaying?this.pause():this.play()},toggleMute:function(){this.video.muted=!this.video.muted},enterFullscreen:function(){this.video.webkitRequestFullscreen();this.isFullscreen=!0},exitFullscreen:function(){window.document.webkitExitFullscreen();this.isFullscreen=!1},toggleFullscreen:function(){this.isFullscreen?this.exitFullscreen():this.enterFullscreen()},
handleVideoEnd:function(a){this.isPlaying=!1;this.isFullscreen&&this.exitFullscreen()},handleClickVideo:function(a){a.ctrlKey?this.toggleFullscreen():this.togglePlayback()},handleMouseWheel:function(a){var b=a.wheelDelta/100*this.wheelSpeed;a.ctrlKey&&(b*=10,a.shiftKey&&(b*=10));this.seek(b)},__class__:r};var A=require("atom").CompositeDisposable,I=require("atom").File,x=function(a,b){this.high=a;this.low=b};x.__name__=!0;x.prototype={__class__:x};var h={__ename__:!0,__constructs__:["Blocked","Overflow",
"OutsideBounds","Custom"],Blocked:["Blocked",0]};h.Blocked.toString=v;h.Blocked.__enum__=h;h.Overflow=["Overflow",1];h.Overflow.toString=v;h.Overflow.__enum__=h;h.OutsideBounds=["OutsideBounds",2];h.OutsideBounds.toString=v;h.OutsideBounds.__enum__=h;h.Custom=function(a){a=["Custom",3,a];a.__enum__=h;a.toString=v;return a};var q=function(a){switch(a){case ".":case "..":this.dir=a;this.file="";return}var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");b<c?(this.dir=m.substr(a,0,c),a=m.substr(a,c+1,null),
this.backslash=!0):c<b?(this.dir=m.substr(a,0,b),a=m.substr(a,b+1,null)):this.dir=null;b=a.lastIndexOf(".");-1!=b?(this.ext=m.substr(a,b+1,null),this.file=m.substr(a,0,b)):(this.ext=null,this.file=a)};q.__name__=!0;q.extension=function(a){a=new q(a);return null==a.ext?"":a.ext};q.prototype={__class__:q};var k=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,k)};k.__name__=!0;k.__super__=Error;k.prototype=function(a,b){function c(){}
c.prototype=a;var f=new c,d;for(d in b)f[d]=b[d];b.toString!==Object.prototype.toString&&(f.toString=b.toString);return f}(Error.prototype,{__class__:k});var d=function(){};d.__name__=!0;d.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=d.__nativeClassName(a);return null!=a?d.__resolveNativeClass(a):null};d.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&
(c="object");switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var f=2,g=a.length;f<g;)var e=f++,c=2!=e?c+(","+d.__string_rec(a[e],b)):c+d.__string_rec(a[e],b);return c+")"}c=a.length;f="[";b+="\t";for(g=0;g<c;)e=g++,f+=(0<e?",":"")+d.__string_rec(a[e],b);return f+"]"}try{f=a.toString}catch(h){return h instanceof k&&(h=h.val),"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&(c=a.toString(),"[object Object]"!=c))return c;c=null;
f="{\n";b+="\t";g=null!=a.hasOwnProperty;for(c in a)g&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=f.length&&(f+=", \n"),f+=b+c+" : "+d.__string_rec(a[c],b));b=b.substring(1);return f+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};d.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var f=0,g=c.length;f<g;){var e=f++,e=c[e];if(e==
b||d.__interfLoop(e,b))return!0}return d.__interfLoop(a.__super__,b)};d.__instanceof=function(a,b){if(null==b)return!1;switch(b){case J:return(a|0)===a;case D:return"number"==typeof a;case E:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case K:return!0;default:if(null!=a)if("function"==typeof b){if(a instanceof b||d.__interfLoop(d.getClass(a),b))return!0}else{if("object"==typeof b&&d.__isNativeObj(b)&&a instanceof b)return!0}else return!1;
return b==L&&null!=a.__name__||b==M&&null!=a.__ename__?!0:a.__enum__==b}};d.__cast=function(a,b){if(d.__instanceof(a,b))return a;throw new k("Cannot cast "+t.string(a)+" to "+t.string(b));};d.__nativeClassName=function(a){a=d.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};d.__isNativeObj=function(a){return null!=d.__nativeClassName(a)};d.__resolveNativeClass=function(a){return y[a]};var l=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=
a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};l.__name__=!0;l.sliceImpl=function(a,b){var c=new F(this,a,null==b?null:b-a),d=new C(c.byteLength);(new F(d)).set(c);return d};l.prototype={slice:function(a,b){return new l(this.a.slice(a,b))},__class__:l};var p=function(){};p.__name__=!0;p._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var f=b++;c[f]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new l(c)}else if(d.__instanceof(a,l))null==b&&(b=0),
null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new l(c);else throw new k("TODO "+t.string(a));c.subarray=p._subarray;c.set=p._set;return c};p._set=function(a,b){if(d.__instanceof(a.buffer,l)){if(a.byteLength+b>this.byteLength)throw new k("set() outside of range");for(var c=0,f=a.byteLength;c<f;){var e=c++;this[e+b]=a[e]}}else if(a instanceof
Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new k("set() outside of range");c=0;for(f=a.length;c<f;)e=c++,this[e+b]=a[e]}else throw new k("TODO");};p._subarray=function(a,b){var c=p._new(this.slice(a,b));c.byteOffset=a;return c};var H=0;module.exports=g;String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;var J={__name__:["Int"]},K={__name__:["Dynamic"]},D=Number;D.__name__=["Float"];var E=Boolean;E.__ename__=["Bool"];var L={__name__:["Class"]},M={},C=y.ArrayBuffer||
l;null==C.prototype.slice&&(C.prototype.slice=l.sliceImpl);var F=y.Uint8Array||p._new;g.allowedFileTypes="3gp avi mov mp4 m4v mkv ogv ogm webm".split(" ");g.config={autoplay:{title:"Autoplay",description:"Autoplay video when opened",type:"boolean","default":!0},loop:{title:"Loop Video",type:"boolean","default":!1},seek_speed:{title:"Keyboard Seek Speed",type:"number","default":.5,minimum:0,maximum:1},wheel_speed:{title:"Mousewheel Seek Speed",type:"number","default":.5,minimum:0,maximum:1},volume:{title:"Default Volume",
type:"number","default":.7,minimum:0,maximum:1}};new x(0,0);d.__toStr={}.toString;p.BYTES_PER_ELEMENT=1})("undefined"!=typeof console?console:{log:function(){}},"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
